!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["dom-scanner"]=t():e["dom-scanner"]=t()}(self,(()=>(()=>{"use strict";function e(e){const t=window.getComputedStyle(e),n=e.getBoundingClientRect();return"none"!==t.display&&"hidden"!==t.visibility&&n.width>0&&n.height>0}function t(e){const t=e.getBoundingClientRect();return{nodeId:crypto.randomUUID(),tag:e.tagName.toLowerCase(),id:e.id||null,classList:e.classList.length?Array.from(e.classList).slice(0,5):null,text:e.textContent?e.textContent.trim().slice(0,100):null,attributes:{role:e.getAttribute("role"),ariaLabel:e.getAttribute("aria-label"),placeholder:e.getAttribute("placeholder"),name:e.getAttribute("name"),type:e.getAttribute("type")},rect:{x:t.x,y:t.y,width:t.width,height:t.height},isVisible:!0,isDisabled:!0===e.disabled}}function n(e=window.location.href){e.includes("keyword=")||e.includes("query=")?this.displayLocation="PRODUCT_SEARCH":e.includes("/product")&&!e.includes("/product/list")?this.displayLocation="PRODUCT_DETAIL":e.includes("/category")||e.includes("/product/list")?this.displayLocation="PRODUCT_LIST":this.displayLocation="HOME";try{const t=new URL(e),n=t.searchParams.get("product_no");if(n)return n;const o=t.pathname,r=/^(?:\/[^\/]+)?\/product\/[^\/]+\/([^\/]+)(?:\/category\/[^\/]+\/display\/[^\/]+\/?)?$/,i=/^(?:\/[^\/]+)?\/product\/[^\/]+\/([^\/]+)/,c=o.match(r),a=o.match(i);return c&&c[1]?c[1]:a&&a[1]?a[1]:null}catch(e){return console.error("Invalid URL:",e),null}}class o{constructor(e){this.partnerType=e.partnerType||"gentoo"}init(){const o=document.createElement("button");o.innerText="Scan",Object.assign(o.style,{position:"fixed",bottom:"16px",right:"16px",zIndex:99999,padding:"8px 12px",fontSize:"12px"}),o.addEventListener("click",(()=>{const o={meta:{shopId:location.hostname,url:location.href,pageType:n(),userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight},scannedAt:(new Date).toISOString()},candidates:Array.from(document.querySelectorAll('button, a, input, select, textarea, [role="button"], [onclick]')).filter(e).map((e=>{const n=[];let o=e.parentElement,r=0;for(;o&&r<3;)n.push(t(o)),o=o.parentElement,r++;const i=Array.from(e.children).slice(0,3).map(t);return{summary:t(e),ancestors:n,descendants:i}}))};console.group("[GENTOO SCAN]"),console.log("PageType:",o.meta.pageType),console.log("Candidates:",o.candidates.length),console.log("Payload:",o),console.groupEnd(),window.__GENTOO_LAST_SCAN__=o})),document.body.appendChild(o)}}var r,i,c,a,s;return window.DomScanner=o,r=window,document,s=(c=r).DomScanner,c.DomScanner=((a=function(){a.q.push(Array.from(arguments)),function(){for(;c.DomScanner.q&&c.DomScanner.q.length;){var e=c.DomScanner.q.shift();c.DomScanner.process(e)}}()}).q=a.q||[],a.process=function(e){var t=e[0],n=e[1]||{};if("boot"!==t)i?"init"===t?"function"==typeof i.init&&Promise.resolve(i.init(n)).catch((e=>{console.error("Failed to initialize DomScanner:",e)})):console.error("DomScanner: Unknown method",t):console.error("DomScanner: Must call boot() before using this method");else try{i=new o(n)}catch(e){console.error("Failed to create DomScanner instance:",e)}},a),s&&s.q&&s.q.forEach((function(e){c.DomScanner.process(e)})),o("boot",{partnerType:"cafe24"}),o("init",{}),{}})()));